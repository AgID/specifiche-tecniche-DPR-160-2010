bottomparticipants 
participant BO
participantgroup #lightblue **Ente Terzo**
actor OperatoreAssegnazioneIstanza #green
actor OperatoreControllo #blue
actor OperatorePreControllo #red
actor OperatoreIstruttore #yellow
end
activate BO
BO -->OperatoreAssegnazioneIstanza: Notifica Istanza\n(e-service **send_instance**)
deactivate BO
activate OperatoreAssegnazioneIstanza
OperatoreAssegnazioneIstanza ->OperatoreControllo: Assegnazione Istanza
activate OperatoreControllo
deactivate OperatoreAssegnazioneIstanza
OperatoreControllo ->OperatoreControllo: Consultazione Assegnazioni


OperatoreControllo ->OperatorePreControllo:Assegnazione Istanza
deactivate OperatoreControllo
activate OperatorePreControllo
OperatorePreControllo ->OperatorePreControllo: Consultazione istanza\n(e-service **instance_descriptor**)


OperatorePreControllo ->OperatoreIstruttore: Assegnazione Istanza
deactivate OperatorePreControllo
activate OperatoreIstruttore
OperatoreIstruttore -> OperatoreIstruttore: Consultazione istanza\n(e-service **instance_descriptor**)

OperatoreIstruttore ->BO: Download documenti \n(e-service **instance_document**)
activate BO
BO --> OperatoreIstruttore: Documenti 
deactivate BO

group #2f2e7b Opt #white [Richiesta d'integrazione]
OperatoreIstruttore ->OperatorePreControllo: Richiesta
deactivate OperatoreIstruttore
activate OperatorePreControllo
OperatorePreControllo ->OperatorePreControllo:Check

group #red If Anomalia Richiesta d'integrazione  #white 
OperatorePreControllo ->OperatoreIstruttore: Segnalazione anomalia
deactivate OperatorePreControllo
activate OperatoreIstruttore
OperatoreIstruttore ->OperatoreIstruttore:Check \nIntegrazione
OperatoreIstruttore ->OperatorePreControllo: Richiesta
deactivate OperatoreIstruttore
activate OperatorePreControllo
end

OperatorePreControllo ->OperatoreControllo: Inserimento Richiesta 
deactivate OperatorePreControllo
activate OperatoreControllo
OperatoreControllo ->OperatoreControllo: check

group #blue If Anomalia Richiesta d'integrazione  #white 
OperatoreControllo ->OperatoreIstruttore: Segnalazione anomalia
activate OperatoreIstruttore
deactivate OperatoreControllo
OperatoreIstruttore ->OperatoreIstruttore:Check \Integrazione
OperatoreIstruttore -> OperatorePreControllo: Inserimento Richiesta
deactivate OperatoreIstruttore
activate OperatorePreControllo
OperatorePreControllo ->OperatorePreControllo: Check
OperatorePreControllo ->OperatoreControllo: Inserimento Richiesta
deactivate OperatorePreControllo
activate OperatoreControllo
end

OperatoreControllo ->BO: Inoltro \n(e-service **request_integration **)
deactivate OperatoreControllo
activate BO
group #yellow If timeout  #blue
BO -#red>OperatoreControllo: Timeout invio integrazione
BO -#red>OperatorePreControllo: Timeout invio integrazione
BO -#red>OperatoreIstruttore: Timeout invio integrazione



end
deactivate OperatoreControllo
BO->OperatoreControllo: Invio Integrazione
BO->OperatorePreControllo: Invio Integrazione

BO->OperatoreIstruttore: Invio Integrazione
deactivate BO
activate OperatoreIstruttore
OperatoreControllo ->OperatoreControllo: Consulto Integrazione
OperatorePreControllo ->OperatorePreControllo: Consulto Integrazione
OperatoreIstruttore ->OperatoreIstruttore: Consulto Integrazione

end
OperatoreIstruttore ->OperatoreIstruttore: Conclusioni
OperatoreIstruttore ->OperatorePreControllo: Inserimento conclusioni

deactivate OperatoreIstruttore
activate OperatorePreControllo
OperatorePreControllo ->OperatorePreControllo: Check

group #red If Anomalia Conclusioni  #white
OperatorePreControllo ->OperatoreIstruttore: Segnalazione Anomalia
activate OperatoreIstruttore
deactivate OperatorePreControllo
OperatoreIstruttore ->OperatoreIstruttore: Check
OperatoreIstruttore ->OperatorePreControllo: Inserimento Conclusioni
deactivate OperatoreIstruttore
activate OperatorePreControllo
OperatorePreControllo ->OperatorePreControllo: Check
end 

deactivate OperatoreIstruttore
OperatorePreControllo ->OperatoreControllo: Inserimento
deactivate OperatorePreControllo
activate OperatoreControllo
OperatoreControllo ->OperatoreControllo: Verifica

group #blue If Anomalia Conclusioni #white
OperatoreControllo ->OperatoreIstruttore: Segnala Anomalia
activate OperatoreIstruttore
deactivate OperatoreControllo

OperatoreIstruttore ->OperatoreIstruttore: Check
OperatoreIstruttore ->OperatorePreControllo: Inserimento
deactivate OperatoreIstruttore
activate OperatorePreControllo
OperatorePreControllo -> OperatorePreControllo: Check
deactivate OperatoreIstruttore
OperatorePreControllo ->OperatoreControllo: Inserimento
deactivate OperatorePreControllo
activate OperatoreControllo
OperatoreControllo ->OperatoreControllo: Verifica
end


OperatoreControllo -> BO: Inoltro \n(e-service **send_conclusions)
deactivate OperatoreControllo

